<html>
  <head>
    <title>Machine Learning</title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.10.0/dist/tf.min.js"></script>
  </head>
  <body class="bg-light">
    <div class="container mt-5">
      <h2 class="text-center mb-4">Machine Learning Örneği</h2>
      <div class="card p-4 shadow">
        <p>Öğrenci başarı tahmin uygulaması</p>
        <button id="trainBtn" class="btn btn-primary">Eğitimi Başlat</button>
      </div>

      <div class="mt-4">
        <h5>Eğitim Çıktısı:</h5>
        <pre
          id="output"
          class="bg-dark text-light p-3 rounded"
          style="height: 300px; overflow: auto"
        ></pre>
      </div>
    </div>
  </body>

  <script>
    $(document).on("click", "#trainBtn", async function () {
      $("#output").text("Eğitim başlatıldı...");
      var model = tf.sequential(); // Model oluşturma
      // birinci gizli katman
      model.add(
        tf.layers.dense({
          units: 8, // 8 nöron
          inputShape: [2], // 2 giriş özelliği ders saati- not ortalaması
          activation: "relu",
        })
      );
      // ikinci gizli katman
      model.add(
        tf.layers.dense({
          units: 4,
          activation: "relu",
        })
      );

      // çıktı katmanı
      model.add(
        tf.layers.dense({
          units: 3, // 3 çıktı (başarı tahmini)
          activation: "softmax",
        })
      );
      // modeli derleme
      model.compile({
        optimizer: tf.train.adam(0.01), // adam optimizasyon algoritması
        loss: "categoricalCrossentropy", // kayıp fonksiyonu
        metrics: ["accuracy"], // doğruluk metriği
      });
      // eğitim verileri (ders saati, not ortalaması) ve etiketler (başarı durumu)
      var xs = tf.tensor2d([
        [1, 50],
        [2, 55],
        [3, 60],
        [4, 65],
        [5, 70],
        [6, 75],
        [7, 80],
        [8, 90],
        [9, 100],
      ]); // 0 - çalışma saati, 1- not ortalaması
      var ys = tf.tensor2d([
        [1, 0, 0],
        [1, 0, 0],
        [1, 0, 0],
        [0, 1, 0],
        [0, 1, 0],
        [0, 1, 0],
        [0, 1, 0],
        [0, 0, 1],
        [0, 0, 1],
      ]); // 1 başta düşük, ortada orta, sonda yüksek başarı

      //
      $("#output").append("\nModel eğitiliyor...\n");
      await model.fit(xs, ys, {
        epochs: 200,
        callbacks: {
          onEpochEnd: (epoch, logs) => {
            $("#output").append(
              `Epoch ${epoch + 1}: loss = ${logs.loss.toFixed(
                4
              )}, accuracy = ${logs.acc.toFixed(4)}\n`
            );
          },
        },
      });
      $("#output").append("Eğitim tamamlandı!\n");
      var testValue = tf.tensor2d([[3, 90]]); // 1 saat çalışma, 90 not ortalaması
      var prediction = model.predict(testValue);
      var results = await prediction.array();
      console.log(results);
    });

    // ödev
    // tensorflow jquery bootsrrap kullanarak duygu analizi veya not hesaplama yapınız
    // transferlearning kullanınız. Kodun kalitesi ve yapılmak istenen yapılmış mı önemli
    // web arayüzü oluşturun, kullanıcıdan veri alın textboxtan aldığınız datadan işlemler yapılacak
    // log tutualacak bir alan olsun.
    // veri seti hazırlancak,
    // modeli eğitin ve sonucu gösterin
    // isterseniz gerçek zamanlı tahmin yapabilirsiniz - ajax vs ile dışarıdan data alabilirsiniz
  </script>
</html>
